<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/static/css/main.css ">
    <title>Vigorize</title>

    <script >
        function showFlashMessages(messages) {
            messages.forEach(message => {
                alert(message);  // Exibe um alerta com a mensagem
            });
        }
    </script>
    
</head>
<body class=" bg-[#F8DCB3] flex min-h-screen">
    <div class="w-[50%] flex items-center justify-center mx-auto">
        <!-- Conteúdo da aba de configuração aqui -->
        <form action="{{ url_for('primeiroAcesso.primeiroAcesso')}}" method="POST" enctype="multipart/form-data">
            <input type="hidden" name="action" value="save_profile">
            
            <!-- Input de arquivo escondido -->
            <input type="file" id="profile-picture" accept="image/*" name="file" required class="hidden" onchange="updateProfilePicturePreview()">
            
            <!-- Botão personalizado -->
             {% if profile_picture_url %}
                <img type="button" id="upload-button" class=" rounded-full block mx-auto w-[360px] h-[360px] cursor-pointer shadow-2xl" src="{{ profile_picture_url }}" onclick="document.getElementById('profile-picture').click();">
            {% else %}
                <img type="button" id="upload-button" class=" rounded-full block mx-auto w-[360px] h-[360px] cursor-pointer shadow-2xl" src="/static/botao_bege.svg" onclick="document.getElementById('profile-picture').click();">
            {% endif %}
            
            <!-- Submit button -->
            <button type="submit" class="bg-[#ED8D00] hover:bg-[#f2a30a] font-bold rounded-full p-2 text-white block mx-auto mt-4">Salvar Foto</button>
        </form>
    </div>
    <div class="bg-[#234035] min-h-screen w-[50%] flex justify-center">
        <div class="w-full max-w-md mt-16">
            <div class="flex justify-center mb-1">
                <img src="/static/VIGORIZE_bege.svg" alt="Logo" class="w-[30%]">
            </div>
            <h1 class="text-[#F8DCB3] text-4xl text-center font-semibold mb-12">Primeiros Passos</h1>
            <form action="{{ url_for('primeiroAcesso.primeiroAcesso')}}" method="POST">

                <input type="hidden" name="action" value="send_data">
            
                <div class="grid grid-rows-1 gap-4 items-center mx-auto w-[60%]">
                    {% for input in inputs %}
                        <input class="bg-[#F8DCB3] p-2 px-5 block w-full rounded-full border border-black text-[#316A55] font-normal placeholder:text-[#316A55] placeholder:font-normal"
                            type="{{ input.type }}" 
                            id="{{ input.id }}" 
                            placeholder="{{ input.placeholder }}"
                            max="{{input.max}}"
                            min="{{input.min}}" 
                            name="{{input.name}}"  
                            required>
                    {% endfor %}
    
                    <select class="bg-[#F8DCB3] p-2 px-5 block w-full rounded-full border border-black text-[#316A55] font-normal placeholder:text-[#316A55] placeholder:font-normal" 
                            id="genero" name="genero" required>
                        <option value="" disabled selected>Sexo:</option>
                        {% for genero in generos %}
                            <option value="{{ genero }}">{{ genero }}</option>
                        {% endfor %}
                    </select>
    
                    <select class="bg-[#F8DCB3] p-2 px-5 block w-full rounded-full border border-black text-[#316A55] font-normal placeholder:text-[#316A55] placeholder:font-normal" 
                            id="fisico" name="fisico" required>
                        <option value="" disabled selected>Atividade Física:</option>
                        {% for fisico in fisicos %}
                            <option value="{{ fisico }}">{{ fisico }}</option>
                        {% endfor %}
                    </select>
    
                    <div class="flex justify-center mt-4">
                        <button class="bg-[#ED8D00] hover:bg-[#f2a30a] font-bold rounded-full py-2 px-8 text-[#234035]">Pronto</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
            <script>
                // Transforma mensagens de flash em um array para o JavaScript
                const messages = {{ messages | tojson }};
                showFlashMessages(messages.map(msg => msg[1]));  // msg[1] é a mensagem, msg[0] é a categoria
            </script>
        {% endif %}
    {% endwith %}

    <script>

        function updateProfilePicturePreview() {
        var fileInput = document.getElementById('profile-picture');
        var uploadButton = document.getElementById('upload-button');
        
        if (fileInput.files && fileInput.files[0]) {
            var reader = new FileReader();
            
            reader.onload = function (e) {
                uploadButton.src = e.target.result;
            }
            
            reader.readAsDataURL(fileInput.files[0]);
        }
    }
    </script>
   
</body>

</html>